<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1920" />
  <title>Smart Light Control</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: #0a0a0a;
      overflow: hidden;
    }

    #loading {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #0a0a0a;
      z-index: 10;
      transition: opacity 0.5s ease;
    }

    #loading.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .bulb-icon {
      font-size: 80px;
      margin-bottom: 24px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.7; }
    }

    .loading-title {
      font-family: Arial, sans-serif;
      font-size: 36px;
      color: #ffffff;
      margin-bottom: 12px;
      letter-spacing: 1px;
    }

    .loading-sub {
      font-family: Arial, sans-serif;
      font-size: 20px;
      color: #888;
    }

    #error-screen {
      display: none;
      position: fixed;
      inset: 0;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #0a0a0a;
      z-index: 20;
    }

    #error-screen.visible {
      display: flex;
    }

    .error-icon {
      font-size: 80px;
      margin-bottom: 24px;
    }

    .error-title {
      font-family: Arial, sans-serif;
      font-size: 36px;
      color: #ff4444;
      margin-bottom: 16px;
    }

    .error-msg {
      font-family: Arial, sans-serif;
      font-size: 22px;
      color: #aaa;
      text-align: center;
      max-width: 800px;
      line-height: 1.5;
    }

    .error-url {
      font-family: monospace;
      font-size: 26px;
      color: #f0c040;
      margin: 20px 0;
    }

    .retry-hint {
      font-family: Arial, sans-serif;
      font-size: 20px;
      color: #666;
      margin-top: 32px;
    }

    #app-frame {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>

  <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div id="loading">
    <div class="bulb-icon">üí°</div>
    <div class="loading-title">Smart Light Control</div>
    <div class="loading-sub">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ 192.168.1.1:8080‚Ä¶</div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ -->
  <div id="error-screen">
    <div class="error-icon">‚ö†Ô∏è</div>
    <div class="error-title">–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</div>
    <div class="error-url">http://192.168.1.1:8080</div>
    <div class="error-msg">
      –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —É–º–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è –≤–∫–ª—é—á—ë–Ω<br>
      –∏ –¢–í –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ Wi-Fi —Å–µ—Ç–∏.
    </div>
    <div class="retry-hint">–ù–∞–∂–º–∏—Ç–µ üî¥ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º -->
  <iframe
    id="app-frame"
    src="http://192.168.1.1:8080"
    frameborder="0"
    allowfullscreen
    sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
  ></iframe>

  <script>
    var TARGET_URL = 'http://192.168.1.1:8080';
    var frame = document.getElementById('app-frame');
    var loading = document.getElementById('loading');
    var errorScreen = document.getElementById('error-screen');

    var TIMEOUT_MS = 10000;
    var timer = null;

    function showError() {
      loading.classList.add('hidden');
      errorScreen.classList.add('visible');
    }

    function hideError() {
      errorScreen.classList.remove('visible');
      loading.classList.remove('hidden');
    }

    function onLoad() {
      clearTimeout(timer);
      loading.classList.add('hidden');
    }

    function onError() {
      clearTimeout(timer);
      showError();
    }

    function startLoad() {
      hideError();
      clearTimeout(timer);
      timer = setTimeout(showError, TIMEOUT_MS);
      frame.src = TARGET_URL + '?t=' + Date.now();
    }

    frame.addEventListener('load', onLoad);
    frame.addEventListener('error', onError);

    // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    timer = setTimeout(showError, TIMEOUT_MS);

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª—å—Ç–æ–º
    document.addEventListener('keydown', function(e) {
      var key = e.keyCode;

      // –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (ColorF0Red) ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
      if (key === 403) {
        startLoad();
      }

      // Back ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º, TizenBrew —Å–∞–º –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç
    });

    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ —á–µ—Ä–µ–∑ Tizen API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
    if (typeof tizen !== 'undefined' && tizen.tvinputdevice) {
      try {
        tizen.tvinputdevice.registerKey('ColorF0Red');
        tizen.tvinputdevice.registerKey('Back');
      } catch(e) {}
    }
  </script>

</body>
</html>
